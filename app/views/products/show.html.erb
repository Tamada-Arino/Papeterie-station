<% provide(:title, @product.name) %>
<h3><%= @product.name %></h3>
<% if user_signed_in? && @product.user.id == current_user.id %>
  <div>
    <%= link_to edit_product_path(@product.id) do %>
      <i class="bi bi-pencil-square"></i> 編集
    <% end %>
  </div>
<% end %>
<p class="text-end">presented by 
  <%= link_to user_path(@product.user.id) do%>
    <%= image_tag @product.user.avatar.attached? ? @product.user.avatar : 'default_avatar.png', class: "avatar-small" %>
    <%= @product.user.name %>
  <% end %>
</p>
<div class="d-flex text-right">
  <% if current_user && @product.favorited_by?(current_user) %>
    <%= button_to product_favorites_path(@product), method: :delete, class: "favorite text-red" do %>
      <i class="bi bi-heart-fill"></i>
    <% end %>
  <% else %>
    <%= button_to product_favorites_path(@product), method: :post, class: "favorite text-secondary" do %>
      <i class="bi bi-heart"></i>
    <% end %>
  <% end %>
  <p class="m-0 text-secondary"><%= @product.favorites.count %> いいね</p>
</div>
<div>
  <div>
    <% if @product.images.present? %>
      <div id="imageCarousel" class="carousel slide">
        <div class="carousel-indicators">
          <% @product.images.each_with_index do |image, i| %>
            <button type="button" data-bs-target="#imageCarousel" data-bs-slide-to="<%= i %>" class="<%= "active" if i.zero? %>" aria-label="Slide <%= i + 1 %>"></button>
          <% end %>
        </div>
        <div class="carousel-inner">
          <% @product.images.each_with_index do |image, i| %>
            <div class="carousel-item <%= "active" if i.zero? %>">
              <%= image_tag image, class: "product-image d-block w-100" %>
            </div>
          <% end %>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#imageCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#imageCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    <% else %>
      <%= image_tag 'noimage.png', class: "product-image d-block w-100" %>
    <% end %>
  </div>
  <% unless @product.price.nil? %>
    <p>参考価格：<%= @product.price.to_s(:delimited) %>円</p>
  <% end %>
  <p><%= @product.description %></p>
</div>
